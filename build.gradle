buildscript {
    apply from: project.rootProject.relativePath('buildscript.gradle'), to: buildscript
}

apply plugin: 'com.athaydes.osgi-run'

allprojects {
    group 'com.neva.javarel'
    version "1.0.0.ALPHA"

    apply plugin: 'idea'

    repositories {
        mavenCentral()
    }
}

dependencies {
    osgiRuntime 'org.slf4j:slf4j-simple:1.7.16'
    osgiRuntime 'org.apache.felix:org.apache.felix.http.bundle:2.3.2'
    osgiRuntime 'org.apache.felix:org.apache.felix.webconsole:3.1.8'
    osgiRuntime 'org.apache.felix:org.apache.felix.configadmin:1.8.8'

    // osgiRuntime 'org.apache.felix:org.apache.felix.http.bundle:3.0.0'
    // osgiRuntime 'org.apache.felix:org.apache.felix.webconsole:4.2.14'
}

runOsgi {
    bundles += IPOJO_ALL_BUNDLES
    bundles += FELIX_GOGO_BUNDLES
    bundles += subprojects // allprojects.findAll { it.plugins.hasPlugin('osgi') }
}

subprojects {
    apply plugin: 'base'

    plugins.withId 'osgi', {
        dependencies {
            compile 'org.jetbrains.kotlin:kotlin-osgi-bundle:1.0.0'

            compile 'org.osgi:org.osgi.enterprise:5.0.0'
            compile 'org.osgi:org.osgi.core:4.3.1'
            compile 'org.apache.felix:org.apache.felix.ipojo.annotations:1.12.1'

            testCompile group: 'junit', name: 'junit', version: '4.11'
        }
    }

}